<!doctype html>
<html ng-app="baseballChant">
<head>
  <title>Baseball Chant</title>
  <style>
    .hidden { visibility: hidden; }
    .chant {
      font-family: sans-serif;
      /* Font size depends on viewport size */
      font-size: 20vmin;
      font-weight: bolder;
      text-align: center;
      height: 100%;
      width: 100%;
      color: white;
      /* Using 4 shadow offsets to simulate text outline */
      text-shadow:
        -1px -1px 2px #000,
         1px -1px 2px #000,
        -1px  1px 2px #000,
         1px  1px 2px #000;
    }
  </style>
</head>
<body ng-controller="Chant as chant" ng-attr-style = "background-color: {{ chant.bg }}">
  <div class="chant" ng-show="chant.beat < 8">
    <div ng-class="{ 'hidden': chant.beat < 0 }">
      {{ chant.a }}
    </div>
    <div ng-class="{ 'hidden': chant.beat < 2 }">
      {{ chant.b }}
    </div>
    <div>
      <span ng-class="{ 'hidden': chant.beat < 4 }">{{ chant.c }}</span><span ng-class="{ 'hidden': chant.beat < 6 }">{{ chant.d }}</span>
    </div>
  </div>
  <div class="chant"  ng-show="chant.beat >= 8">
    <div ng-class="{ 'hidden': chant.beat < 8 }">
      CLAP
    </div>
    <div>
      <span ng-class="{ 'hidden': chant.beat < 12 }">CLAP</span>
      <span ng-class="{ 'hidden': chant.beat < 13 }">CLAP</span>
      <span ng-class="{ 'hidden': chant.beat < 14 }">CLAP</span>
    </div>
    <div ng-class="{ 'hidden': chant.beat < 10 }">
      CLAP
    </div>
  </div>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.js"></script>
  <script>
    (function() {
      'use strict';

      angular
        .module('baseballChant', [])
        .controller('Chant', Chant);

      Chant.$inject = ['$interval', '$location'];

      function Chant($interval, $location) {
        var vm = this;
        vm.promise = null;
        vm.beat = 0;

        // Grab values from url parameters if present
        vm.params = $location.search();
        vm.a = vm.params.a || "Let's";
        vm.b = vm.params.b || "Go";
        vm.c = vm.params.c || "Ran";
        vm.d = vm.params.d || "gers";
        vm.bg = vm.params.bg || "#003279";
        vm.beat = parseInt(vm.params.beat) || 200;

        // Advance beat count
        vm.NextBeat = function() {
          if (++vm.beat >= 16) vm.beat = 0;
        }

        vm.StartInterval = function() {
          vm.StopInterval();
          vm.promise = $interval(vm.NextBeat, vm.beat)
        }

        vm.StopInterval = function() {
          if (vm.promise) vm.promise.cancel();
        }

        // Start the beat!
        vm.StartInterval();
      }
    })();
  </script>
</body>
</html>
